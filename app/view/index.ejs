<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>GearHike Inventory</title>
  
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.0/font/bootstrap-icons.css">

  <style>
    body {
      font-family: 'Poppins', sans-serif;
      background-color: #f8f9fa;
    }
    .navbar {
      background: linear-gradient(90deg, #2c3e50, #4ca1af); /* Nuansa Outdoor */
    }
    .stat-card {
      transition: transform 0.2s;
      border: none;
      border-radius: 15px;
      box-shadow: 0 4px 6px rgba(0,0,0,0.1);
    }
    .stat-card:hover {
      transform: translateY(-5px);
    }
    .main-card {
      border-radius: 15px;
      border: none;
      box-shadow: 0 0 20px rgba(0,0,0,0.05);
      background: white;
      padding: 25px;
      margin-bottom: 30px;
    }
    .table-action-form .form-control, 
    .table-action-form .form-select {
      font-size: 0.85rem;
      padding: 0.25rem 0.5rem;
    }
  </style>
</head>
<body>

  <nav class="navbar navbar-dark mb-4 shadow-sm">
    <div class="container">
      <span class="navbar-brand mb-0 h1 fw-bold">
        <i class="bi bi-tree-fill me-2"></i>GearHike
      </span>
      <span class="text-white opacity-75 small">Sistem Peminjaman Alat Outdoor</span>
    </div>
  </nav>

  <div class="container">
    
    <div class="row mb-4">
      <div class="col-12"><h5 class="fw-bold text-secondary mb-3">ðŸ“¦ Ringkasan Stok</h5></div>
      <% categories.forEach(cat => { %>
        <div class="col-md-3 col-sm-6 mb-3">
          <div class="card stat-card h-100">
            <div class="card-body d-flex align-items-center justify-content-between">
              <div>
                <h6 class="text-muted text-uppercase small fw-bold mb-1"><%= cat.name %></h6>
                <h2 class="mb-0 fw-bold text-dark"><%= cat.total_gears %></h2>
              </div>
              <div class="fs-1 text-success opacity-25">
                <i class="bi bi-box-seam"></i>
              </div>
            </div>
          </div>
        </div>
      <% }) %>
    </div>

    <div class="main-card">
      <h5 class="fw-bold mb-3 text-primary"><i class="bi bi-plus-circle me-2"></i>Tambah Gear Baru</h5>
      <form method="POST" action="/gears" class="row g-3">
        <div class="col-md-3">
          <label class="form-label small text-muted">Kategori</label>
          <select name="category_id" class="form-select" required>
            <% categories.forEach(cat => { %>
              <option value="<%= cat.id %>"><%= cat.name %></option>
            <% }) %>
          </select>
        </div>
        <div class="col-md-4">
          <label class="form-label small text-muted">Nama Barang</label>
          <input type="text" name="name" class="form-control" placeholder="Contoh: Tenda Dome" required>
        </div>
        <div class="col-md-2">
          <label class="form-label small text-muted">Berat (gram)</label>
          <input type="number" name="weight" class="form-control" placeholder="0" required>
        </div>
        <div class="col-md-2">
          <label class="form-label small text-muted">Status Awal</label>
          <select name="status" class="form-select">
            <option value="Ready">Ready</option>
            <option value="Borrowed">Borrowed</option>
          </select>
        </div>
        <div class="col-md-1 d-flex align-items-end">
          <button type="submit" class="btn btn-primary w-100"><i class="bi bi-save"></i></button>
        </div>
      </form>
    </div>

    <div class="main-card">
      <div class="d-flex justify-content-between align-items-center mb-3">
        <h5 class="fw-bold text-dark mb-0"><i class="bi bi-list-ul me-2"></i>Daftar Inventory</h5>
      </div>

      <div class="table-responsive">
        <table class="table table-hover align-middle">
          <thead class="table-light">
            <tr>
              <th width="15%">Kategori</th>
              <th width="20%">Nama Item</th>
              <th width="10%">Berat</th>
              <th width="10%">Status</th>
              <th width="45%">Edit / Update Data</th>
            </tr>
          </thead>
          <tbody>
            <% gears.forEach(gear => { %>
              <tr>
                <td><span class="badge bg-secondary rounded-pill"><%= gear.category_name %></span></td>
                <td class="fw-bold text-dark"><%= gear.name %></td>
                <td class="text-muted small"><%= gear.weight %> g</td>
                <td>
                  <% if (gear.status === 'Ready') { %>
                    <span class="badge bg-success bg-opacity-10 text-success px-3 py-2 rounded-pill">Ready</span>
                  <% } else { %>
                    <span class="badge bg-warning bg-opacity-10 text-warning px-3 py-2 rounded-pill">Dipinjam</span>
                  <% } %>
                </td>
                
                <td>
                  <div class="card p-2 bg-light border-0">
                    <form method="POST" action="/gears/update/<%= gear.id %>" class="row g-1 table-action-form align-items-center">
                      
                      <div class="col-3">
                        <select name="category_id" class="form-select form-select-sm border-0 shadow-sm">
                          <% categories.forEach(cat => { %>
                            <option value="<%= cat.id %>" <%= cat.id === gear.category_id ? 'selected' : '' %>>
                              <%= cat.name %>
                            </option>
                          <% }) %>
                        </select>
                      </div>

                      <div class="col-3">
                        <input type="text" name="name" value="<%= gear.name %>" class="form-control form-control-sm border-0 shadow-sm">
                      </div>
                      
                      <div class="col-2">
                        <input type="number" name="weight" value="<%= gear.weight %>" class="form-control form-control-sm border-0 shadow-sm">
                      </div>

                      <div class="col-2">
                        <select name="status" class="form-select form-select-sm border-0 shadow-sm">
                          <option value="Ready" <%= gear.status === 'Ready' ? 'selected' : '' %>>Ready</option>
                          <option value="Borrowed" <%= gear.status === 'Borrowed' ? 'selected' : '' %>>Out</option>
                        </select>
                      </div>

                      <div class="col-2 d-flex gap-1">
                        <button type="submit" class="btn btn-sm btn-success shadow-sm" title="Simpan Perubahan">
                          <i class="bi bi-check-lg"></i>
                        </button>
                    </form>
                        <form method="POST" action="/gears/delete/<%= gear.id %>" onsubmit="return confirm('Hapus barang ini?');">
                          <button type="submit" class="btn btn-sm btn-danger shadow-sm" title="Hapus Barang">
                            <i class="bi bi-trash"></i>
                          </button>
                        </form>
                      </div>

                  </div>
                </td>
              </tr>
            <% }) %>
          </tbody>
        </table>
        
        <% if (gears.length === 0) { %>
          <div class="text-center py-5 text-muted">
            <i class="bi bi-backpack display-1 mb-3"></i>
            <p>Belum ada gear yang didaftarkan.</p>
          </div>
        <% } %>
      </div>
    </div>
    
    <footer class="text-center text-muted py-4 small">
      &copy; 2026 GearHike Inventory System
    </footer>

  </div>

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>